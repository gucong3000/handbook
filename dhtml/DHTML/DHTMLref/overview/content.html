
<HTML >
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=gb2312" />
<TITLE>About Dynamic</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../common/ie4.css" />
<LINK REL="stylesheet" TYPE="text/css" HREF="../common/ie5.css" />
<style>
BODY
{
font-family:verdana,arial,helvetica;
margin:0;
}
</style>
<SCRIPT LANGUAGE="javascript" SRC="../common/common.js"></SCRIPT>
<SCRIPT LANGUAGE="javascript" SRC="../common/browdata.js"></SCRIPT>
<SCRIPT LANGUAGE="javascript" SRC="../common/toolbar.js"></SCRIPT>
<LINK REL="stylesheet" TYPE="text/css" HREF="../common/ie4.css" />
<LINK REL="stylesheet" TYPE="text/css" HREF="../common/inetsdk.css" />
<LINK REL="stylesheet" TYPE="text/css" HREF="../common/default.css" />




<SCRIPT>
var gbDBG = true;
</SCRIPT>
<SCRIPT LANGUAGE="JavaScript1.2">
var gsHTCPath = "../common/";
var gsGraphicsPath = "../common/";
var gsCodePath = "../common/";
</SCRIPT>
<SCRIPT LANGUAGE="JavaScript1.2">
var gsContextMenuPath = gsHTCPath + "contextmenu.htc";
var gsCodeDecoPath = gsHTCPath + "codedeco.htc";
var gsStoreName="workshop";
var gsGraphicsPath = "../common/";
</SCRIPT>
<SCRIPT LANGUAGE="JavaScript1.2">
function CMemberInfo()
{   this.defView = 'all';
}
var g_oMemberInfo = new CMemberInfo();
</SCRIPT>
<SCRIPT LANGUAGE="JavaScript1.2">
function InitPage()
{
if (!assert( (typeof(oBD) == 'object' && oBD != null), "browdata object unavailable!") )
{
return;
}
if ("MSIE" == oBD.browser && oBD.majorVer >= 5 && (oBD.platform.toLowerCase()!="x" && oBD.platform!="Mac" && oBD.platform!="PPC" ))
{
if (typeof(PostGBInit) == 'function') PostGBInit();
if (typeof(PostInit) == 'function') PostInit();
if (typeof(initTabbedMembers) == 'function') initTabbedMembers();
if (typeof(hideExamples) == 'function') hideExamples();
}
if (oBD.getsNavBar && oBD.platform!="PPC" )
{
if (typeof(SetShowMes) == 'function') SetShowMes();
}
}
function assert(bCond, sMsg)
{
if (bCond) { return true; }
else { if (gbDBG) { alert(sMsg); } return false; }
}
window.onload = InitPage;
</SCRIPT>
<SCRIPT LANGUAGE="JavaScript1.2">
function PreInit()
{
if (top == self)
location.replace("http://" + document.domain +"/library/default.html?url=" + document.URL.substring("http://".length + document.domain.length));
}
</SCRIPT>
<SCRIPT LANGUAGE="JavaScript">
</script>
</HEAD> <BODY TOPMARGIN="0"  LEFTMARGIN="0" MARGINHEIGHT="0" MARGINWIDTH="0" BGCOLOR="#FFFFFF" TEXT="#000000">
<TABLE STYLE="table-layout:fixed" class='clsContainer' CELLPADDING='15' CELLSPACING='0' float='left' WIDTH='100%' BORDER='0'> <TR> <TD VALIGN='top'>
<DIV CLASS="clsDocBody"><TABLE WIDTH="97%" CELLPADDING="0" CELLSPACING="0"><TR><TD><H1>About Dynamic Content
</H1></TD><TD ALIGN="right"><A HREF="../default.html" TITLE="This index is only for content formerly found in the Web Workshop." TARGET="_top">Internet Development Index</A></TD></TR></TABLE>
<HR SIZE="1"></HR><p>Before Microsoft&#174; Internet Explorer 4.0, once a Web page was loaded into a user's browser, changing the information displayed on the page required another round-trip to the server. The user interacted with the page (submitted a form, or clicked a link to another page), and the server delivered a new page to the client. Any customization of the information (such as building the page on the fly from a template) required that the server spend additional time processing a page request. Furthermore, the only way to maintain the context for the page's content was to use frame sets, where one frame's content stays constant and another frame changes its content based on the user's activity on the initial page.</p><p>Dynamic content is all about changing the content of the HTML document&#151;inserting and deleting elements or the contents of an element before or after the document has been loaded.</p><p>Internet Explorer 4.0 gives you a rich set of properties and methods to dynamically construct and alter Web pages on the fly. For example, a script can insert a list of section titles at the beginning of the document, or replace that list with a list of links to the actual sections in the document.</p><p>The following topics show how to dynamically access and modify the content in your Web pages: </p><UL><LI><A TARGET="_self" HREF="#dc_changing">Changing HTML Content</A></LI><LI><A TARGET="_self" HREF="#dc_adding">Adding Document Content</A></LI><LI><A TARGET="_self" HREF="#dc_building">Example: Building a Table of Contents</A></LI><LI><A TARGET="_self" HREF="#unknown_713">Which Elements Will This Work For?</A></LI><LI><A TARGET="_self" HREF="#related_topics">Related Topics</A></LI></UL><H2><A NAME="dc_changing"></A>Changing HTML Content</H2><p>Internet Explorer 4.0 provides a set of properties and methods on each element that are designed to make it quite simple to change the document. There are four properties that provide the ability to see what's inside an element on the page and replace that content with new information: <A HREF="../properties/innertext.html">innerText</A>, <A HREF="../properties/outertext.html">outerText</A>, <A HREF="../properties/innerhtml.html">innerHTML</A>, and <A HREF="../properties/outerhtml.html">outerHTML</A>. </p><p>Assigning new text (also called a "string") to one of these properties replaces the contents of the element, including any elements contained by that element, with the new string. Consider the following HTML for an <A HREF="../objects/hn.html">H1</A> heading. </p><PRE CLASS="clsCode" AUTOHILITE="1">&lt;H1 id=myH1&gt;Dynamic Content is Very Cool!&lt;/H1&gt;</PRE><p>The content of the <B>H1</B> can be changed with the <B>innerText</B> property. </p><PRE CLASS="clsCode" AUTOHILITE="1">document.all.myH1.innerText = "DHTML is Very Cool"</PRE><p>The <B>H1</B> element remains in the document, while the content of the <B>H1</B> changes to contain the new string "DHTML is Very Cool". The string assigned to <B>innerText</B> renders any HTML tags as text, and does not process the HTML. To insert HTML code into the contents of another element, you must use the <B>innerHTML</B> property. </p><PRE CLASS="clsCode" AUTOHILITE="1">document.all.myH1.innerHTML = "DHTML is &lt;I&gt;Very&lt;/I&gt; Cool!"</PRE><p>The new string replaces the original content of the <B>H1</B>, and the word "Very" appears in italic. </p><p>The <B>outerText</B> and <B>outerHTML</B> properties represent the element itself, as well as the contents of the element. Assuming that the preceding example is contained by a <A HREF="../objects/body.html">body</A> element, using an <B>outerText</B> property on the <B>H1</B> replaces the entire element with the string attached. The following script causes the <B>H1</B> to go away entirely, and the text string appears where the element was in the flow of the <B>body</B>'s content. </p><PRE CLASS="clsCode" AUTOHILITE="1">document.all.myspan.outerText = "DHTML is VERY Cool!"</PRE><p>The <B>outerHTML</B> property replaces the element with rich HTML. Much like the example above where HTML was inserted in the <B>H1</B>, using the <B>outerHTML</B> property will do the same, except the <B>H1</B> would also be removed. </p><PRE CLASS="clsCode" AUTOHILITE="1">document.all.myH1.outerHTML = "&lt;SPAN STYLE='height:0;width:200;FILTER:Shadow(color=#00FF00)'&gt;RICH HTML&lt;/SPAN&gt;";</PRE><DIV><DIV CLASS="clsShowMe">This feature requires Microsoft&#174; Internet Explorer 4.0 or later. Click the following icon to install the latest version. Then reload this page to view the sample.</DIV><A HREF="/workshop/downloadie.html"><IMG BORDER="0" WIDTH="88" HEIGHT="31" showme="Microsoft Internet Explorer" SRC="../common/ieget_animated.gif" MINVER="4.0" SAMPLEPATH="/workshop/samples/author/dhtml/overview/cont_01.htm" FEATURES="top=50,left=50,height=500,width=650,menubar=yes, toolbar=no, status=yes, scrollbars=yes, resizable=yes"></IMG></A></DIV><H2><A NAME="dc_adding"></A>Adding Document Content</H2><p>The properties described above replace the entire contents of an element with a new string. What if you only want to insert new text or HTML and don't want to change what is already in the document? There are two helper methods on most elements that help you do just this. </p><p>These methods, <A HREF="../methods/insertadjacenthtml.html">insertAdjacentHTML</A> and <A HREF="../methods/insertadjacenttext.html">insertAdjacentText</A>, place the new content at the beginning or end of the element, leaving the existing content intact. These methods all take a parameter that indicates one of four possible places the new content can be inserted with regard to the element: BeforeBegin, AfterBegin, BeforeEnd, and AfterEnd.</p><p>The following example appends a new paragraph to the end of the document when it loads. </p><PRE CLASS="clsCode" AUTOHILITE="1">&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Dynamic Content: Inserting Elements&lt;/TITLE&gt;
&lt;SCRIPT LANGUAGE="JScript"&gt;
function fnAdd(){
document.body.insertAdjacentHTML("BeforeEnd", "&lt;P&gt;" +
oSelect.value + "&lt;/P&gt;");
}
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;P&gt;
&lt;SELECT ID=oSelect&gt;
&lt;OPTION VALUE="Add some &lt;B&gt;Bold&lt;/B&gt; text"&gt;
Add some &amp;lt;B&amp;gt;Bold&amp;lt;/B&amp;gt; text&lt;/OPTION&gt;
&lt;OPTION VALUE="My Dog has the &lt;span style='color:red;letter-spacing:5px'&gt;longest&lt;/span&gt; snout"&gt;
My Dog has the &amp;lt;span style='color:red;text-spacing:2px'&amp;gt;longest&amp;lt;/span&amp;gt; snout.&lt;/OPTION&gt;
&lt;OPTION VALUE="&lt;span onclick=alert('Hello')&gt;Click Me&lt;/span&gt;"&gt;
&amp;lt;span onclick=alert('Hello')&amp;gt;Click Me&amp;lt;/span&amp;gt;&lt;/OPTION&gt;
&lt;/SELECT&gt;
&lt;INPUT TYPE=button VALUE="Add" onclick="fnAdd()"&gt;
&lt;/P&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;</PRE><DIV><DIV CLASS="clsShowMe">This feature requires Microsoft&#174; Internet Explorer 4.0 or later. Click the following icon to install the latest version. Then reload this page to view the sample.</DIV><A HREF="/workshop/downloadie.html"><IMG BORDER="0" WIDTH="88" HEIGHT="31" showme="Microsoft Internet Explorer" SRC="../common/ieget_animated.gif" MINVER="4.0" SAMPLEPATH="/workshop/samples/author/dhtml/overview/cont_02.htm" FEATURES="top=50,left=50,height=500,width=650,menubar=yes, toolbar=no, status=yes, scrollbars=yes, resizable=yes"></IMG></A></DIV><H2><A NAME="dc_building"></A>Example: Building a Table of Contents</H2><p>Building a table of contents is a good example of dynamic content at its best. By using a relatively small amount of script, you can automatically generate a detailed list of the contents of any document. </p><p>This example consists of three functions: buildTOC, setAnchor, and setLink. The buildTOC function creates the table of contents, calling the other two functions to apply anchors and insert the links. The example depends on the document having an element, such as <A HREF="../objects/div.html">div</A> or <A HREF="../objects/p.html">p</A>, that has the identifier MyTOC. The setLink function inserts the links there. To build the table successfully, buildTOC cannot be called until the document is fully loaded. </p><p>Once buildTOC is called, it uses the <A HREF="../collections/all.html">all</A> collection to check each element to see whether it is a header element: <B>H1</B>, <B>H2</B>, <B>H3</B>, or <B>H4</B>. It starts the search at the first element after the <B>body</B> element since no links are possible before this. When it finds a header, it sets the "level" variable and calls the setAnchor and setLink functions. </p><PRE CLASS="clsCode" AUTOHILITE="1">function buildTOC() {
var coll = document.all;
var level;
var id;
for (i=document.body.sourceIndex+1; i&lt;coll.length; i++) {
switch (coll[i].tagName) {
case "H1":
level = 0;
break;
case "H2":
level = 1;
break;
case "H3":
level = 2;
break;
case "H4":
level = 3;
break;
default:
level = -1;
}
if (level!=-1) {
id = i;
setAnchor(coll[i], id);
i++;
setLink(coll[i], level, id);
i+=2;
}
}
}</PRE><p>Notice how the variable "i" is updated after the call to setAnchor and setLink. These functions insert new elements into the document, causing the <B>all</B> collection to be immediately updated and requiring a new index value for the heading. The setAnchor function inserts one element before the heading, so the index is increased by one; the setLink function inserts two elements at the top of the document, so the index is increased by two. </p><p>The setAnchor function adds an <A HREF="../objects/a.html">a</A> element to the document, inserting the start and end tags for this element immediately before and after the header tag, and setting the <B>NAME=</B> attribute of the new element to be equal to the "id" parameter passed to the function. </p><PRE CLASS="clsCode" AUTOHILITE="1">function setAnchor(el, id) {
el.insertAdjacentHTML("BeforeBegin", "&lt;A NAME=\"" + id + "\"&gt;");
el.insertAdjacentHTML("AfterEnd", "&lt;/A&gt;");
}</PRE><p>The setLink function adds another <B>a</B> element to the document. This time the element is a link to the heading that setAnchor just created an anchor for. The <B>HREF=</B> attribute is set to the same "id" value as was set in the matching anchor. Notice that the setLink function places the link just before the end of the element having the identifier MyTOC, separating it from the previous link with a <A HREF="../objects/br.html">br</A> element and inserting zero or more nonbreaking spaces for a very simple way to indicate the heading level. </p><PRE CLASS="clsCode" AUTOHILITE="1">function setLink(el, level, id) {
MyTOC.insertAdjacentHTML("BeforeEnd", "
");
var s = "&amp;nbsp;";
for (j=0; j&lt;level; j++)
s = s + s;
MyTOC.insertAdjacentHTML("BeforeEnd",
s + "&lt;A HREF=\"#" + id + "\"&gt;" + el.innerText + "&lt;/A&gt;");
}</PRE><DIV><DIV CLASS="clsShowMe">This feature requires Microsoft&#174; Internet Explorer 4.0 or later. Click the following icon to install the latest version. Then reload this page to view the sample.</DIV><A HREF="/workshop/downloadie.html"><IMG BORDER="0" WIDTH="88" HEIGHT="31" showme="Microsoft Internet Explorer" SRC="../common/ieget_animated.gif" MINVER="4.0" SAMPLEPATH="/workshop/samples/author/dhtml/overview/cont_03.htm" FEATURES="top=50,left=50,height=500,width=650,menubar=yes, toolbar=no, status=yes, scrollbars=yes, resizable=yes"></IMG></A></DIV><p>There are a few things to keep in mind when you are dynamically changing content in your Web page. </p><p>Can't modify the content until after the document has been loaded:  Keep in mind that you cannot assign a string to these properties until the document has been completely loaded, that is, until the <A HREF="../events/onload.html">onload</A> event occurs. If you attempt to do so before loading, an error occurs. </p><p>Be careful! When you add an element to a document, the <B>all</B> and other element collections are automatically updated to reflect the change. This also affects the value of the <A HREF="../properties/sourceindex.html">sourceIndex</A> for elements that follow the new elements. If you have saved the index value of an element, be careful to update that value or retrieve a new value whenever you add or delete elements in a document. </p><p>Can't put invalid HTML in the document:  You cannot assign a string to <B>innerHTML</B> or <B>outerHTML</B> that contains invalid HTML. For example, trying to replace the content of the <B>p</B> element with another <B>p</B> will fail. A <B>p</B> element can only contain text and inline elements. However, replacing the entire <B>p</B> element with another <B>p</B> would work just fine. </p><H2><A NAME="unknown_713"></A>Which Elements Will This Work For?</H2><p>Here are a few guidelines for which elements you can expect these properties and methods to work. </p><p>Only elements that appear in the <A HREF="../objects/body.html">BODY</A> of the document can be changed with these properties. You can replace the contents of the <B>BODY</B>, but you can't replace the <B>BODY</B> itself. </p><p>This should be obvious, but deserves mention anyway: you can't replace the contents of an element where the element type doesn't have any contents like the replaced elements, <A HREF="../objects/input.html">input</A> and <A HREF="../objects/img.html">img</A>. </p><p>The contents of a <A HREF="../objects/td.html">td</A> can be changed (<B>innerText</B> and <B>innerHTML</B>) and the <A HREF="../objects/table.html">table</A> element itself can be replaced (<B>outerText</B> and <B>outerHTML</B>), but no other table elements and their contents can be changed with these properties. </p><H2><A NAME="related_topics">Related Topics</A></H2><P></P><UL><LI><A HREF="/workshop/author/dyncontent/textrange.html">Using the TextRange Object</A></LI><LI><A HREF="/workshop/author/dyncontent/finding_text.html">Finding Text in the Document</A></LI></UL><info><product rid="prod_IE" minver="4.0"></product></info></DIV>
</TD> </TR> </TABLE>
</BODY> </HTML>